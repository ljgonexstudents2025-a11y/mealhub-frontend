<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Check Azure Tables</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            border-radius: 4px;
        }
        button:hover {
            background: #1177bb;
        }
        pre {
            background: #252526;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            border: 1px solid #3e3e42;
        }
        .error {
            color: #f48771;
        }
        .success {
            color: #89d185;
        }
        h2 {
            color: #4ec9b0;
        }
    </style>
</head>
<body>
    <h1>üîç Azure Table Storage Debug Tool</h1>
    
    <div>
        <h2>Test Restaurants Table</h2>
        <button onclick="testRestaurants('Salamanca')">Check Salamanca</button>
        <button onclick="testRestaurants('Chamberi')">Check Chamber√≠</button>
        <button onclick="testRestaurants('Chamartin')">Check Chamart√≠n</button>
        <pre id="restaurantsResult">Click a button to test...</pre>
    </div>

    <div>
        <h2>Test Meals Table</h2>
        <button onclick="testMeals('Salamanca')">Check Salamanca</button>
        <button onclick="testMeals('Chamberi')">Check Chamber√≠</button>
        <button onclick="testMeals('Chamartin')">Check Chamart√≠n</button>
        <pre id="mealsResult">Click a button to test...</pre>
    </div>

    <div>
        <h2>Config Check</h2>
        <pre id="configResult">Loading config...</pre>
    </div>

    <script src="./config.js"></script>
    <script src="./app.js"></script>
    <script>
        const restaurantsResult = document.getElementById('restaurantsResult');
        const mealsResult = document.getElementById('mealsResult');
        const configResult = document.getElementById('configResult');

        // Display config
        configResult.innerHTML = JSON.stringify(window.APP_CONFIG, null, 2);

        async function testRestaurants(area) {
            restaurantsResult.innerHTML = `Testing Restaurants table for area: ${area}...\n`;
            try {
                const restaurants = await window.MealHub.listRestaurantsByArea(area);
                restaurantsResult.innerHTML = `<span class="success">‚úì Success!</span>\n`;
                restaurantsResult.innerHTML += `Found ${restaurants.length} restaurant(s)\n\n`;
                restaurantsResult.innerHTML += JSON.stringify(restaurants, null, 2);
            } catch (error) {
                restaurantsResult.innerHTML = `<span class="error">‚úó Error:</span>\n${error.message}\n\n`;
                restaurantsResult.innerHTML += `Stack: ${error.stack}`;
            }
        }

        async function testMeals(area) {
            mealsResult.innerHTML = `Testing Meals table for area: ${area}...\n`;
            try {
                const meals = await window.MealHub.listMealsByArea(area);
                mealsResult.innerHTML = `<span class="success">‚úì Success!</span>\n`;
                mealsResult.innerHTML += `Found ${meals.length} meal(s)\n\n`;
                mealsResult.innerHTML += JSON.stringify(meals, null, 2);
            } catch (error) {
                mealsResult.innerHTML = `<span class="error">‚úó Error:</span>\n${error.message}\n\n`;
                mealsResult.innerHTML += `Stack: ${error.stack}`;
            }
        }

        // Auto-test Salamanca on load
        window.addEventListener('load', () => {
            testRestaurants('Salamanca');
            testMeals('Salamanca');
        });
    </script>
</body>
</html>
